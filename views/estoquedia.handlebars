<main>
    <div class="container pt-3">
        {{#if success_msg}}
        <div id="flash-msg" class="alert alert-success">{{success_msg}}</div>
        {{/if}}

        {{#if error_msg}}
        <div id="flash-msg" class="alert alert-danger">{{error_msg}}</div>
        {{/if}}

        {{#if produtos.length}}
        <div class="d-flex flex-wrap justify-content-center gap-4">
            {{#each produtos}}
            <div class="card shadow-sm border-0" style="width: 18rem; border-radius: 16px; background-color: #f8f9fa;">
                <img src="/imagem/{{imagem}}" class="card-img-top rounded-top" alt="{{nome}}"
                    style="height: 180px; object-fit: cover;">

                <div class="card-body">
                    <h5 class="card-title text-primary fw-bold text-center">{{nome}}</h5>

                    <p class="mb-1 text-center">
                        <strong>Valor:</strong> {{valor}} R$
                    </p>
                    <p class="mb-3 text-center">
                        <strong>Estoque:</strong> {{quantidade}} {{unidade_medida}}
                    </p>

                    <div class="d-flex justify-content-between">
                        <a href="/editar/{{codigo}}/{{imagem}}" class="btn btn-outline-warning w-100 me-2">Editar</a>

                        <!-- Botão que abre o modal -->
                        <button type="button" class="btn btn-outline-danger w-100" data-bs-toggle="modal"
                            data-bs-target="#modal-remover-{{codigo}}">
                            Remover
                        </button>
                    </div>
                </div>
            </div>

            <!-- Modal único por produto -->
            <div class="modal fade" id="modal-remover-{{codigo}}" data-bs-backdrop="static" data-bs-keyboard="false"
                tabindex="-1" aria-labelledby="modalLabel-{{codigo}}" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content rounded-3 shadow">
                        <div class="modal-header">
                            <h5 class="modal-title" id="modalLabel-{{codigo}}">Remover</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Fechar"></button>
                        </div>
                        <div class="modal-body">
                            Você tem certeza que quer mover este item para a lixeira? <strong>{{nome}}</strong>?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <a href="/remover/{{codigo}}" class="btn btn-danger">Remover</a>
                        </div>
                    </div>
                </div>
            </div>
            {{/each}}
        </div>
        {{else}}
        <div class="alert alert-info text-center mt-5" role="alert">
            Nenhum produto em estoque.<br />
            <a href="/" class="fw-bold text-decoration-none">Clique aqui para adicionar</a>.
        </div>
        {{/if}}
    </div>
</main>